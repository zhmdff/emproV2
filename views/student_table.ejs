<%- include('./includes/head') %>
<%- include('./includes/aside', { path: path }) %>
<%- include('./includes/navbar', { username: username }) %>

<!-- Content -->

<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Student /</span> List</h4>

    <!-- Search Form -->
    <form method="GET" action="/student/table" class="mb-4">
        <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="Search by name or surname" value="<%= search %>">
            <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </form>

    <!-- Bordered Table -->
    <div class="card">
        <h5 class="card-header">All Students</h5>
        <div class="card-body">
            <div class="table-responsive text-nowrap">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Surname</th>
                            <th>Name</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Phone Number</th>
                            <th>Address Line</th>
                            <th>Course</th>
                            <th>Birthdate</th>
                            <th>Group Name</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% info.forEach((row) => { %>
                        <tr>
                            <td><%= row.surname %></td>
                            <td><%= row.name %></td>
                            <td><%= row.username %></td>
                            <td><%= row.email %></td>
                            <td><%= row.phone_number %></td>
                            <td><%= row.address_line %></td>
                            <td><%= row.course %></td>
                            <td>
                                <% if (row.birthdate && !isNaN(Date.parse(row.birthdate))) { 
                                     const dateObj = new Date(row.birthdate);
                                     const day = String(dateObj.getDate()).padStart(2, '0');
                                     const month = String(dateObj.getMonth() + 1).padStart(2, '0');
                                     const year = dateObj.getFullYear();
                                %>
                                  <%= `${day}/${month}/${year}` %>
                                <% } else { %>
                                  N/A
                                <% } %>
                            </td>                                                                                        
                            <td><%= row.group_name %></td>
                            <td><%= row.education_type %></td>
                        </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </div>
            <!-- Pagination -->
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-end" style="margin-right: 20px;">
                    <% for (let i = 1; i <= totalPages; i++) { %>
                        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                            <a class="page-link" href="/student/table?page=<%= i %>&search=<%= search %>"><%= i %></a>
                        </li>
                    <% } %>
                </ul>
            </nav>
    </div>
    <!--/ Bordered Table -->



</div>
<!-- / Content -->

<%- include('./includes/footer') %>
<%- include('./includes/foot') %>
